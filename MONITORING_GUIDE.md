# 股票监控系统使用指南

## 概述

巴菲特股票监控系统针对 `sample_stocks.txt` 中的股票列表，使用巴菲特投资策略进行买入和卖出点监控，在交易日的交易时间内定时执行分析。

## 功能特点

### 🔍 智能信号检测
- **买入信号**: 基于高评分、高股息率、低估值、技术位置等综合判断
- **卖出信号**: 基于评分下降、股息率降低、估值过高、基本面恶化等判断
- **信号强度**: 分为弱、中、强三个等级，强信号重点关注

### ⏰ 交易时间监控
- **监控时间**: 工作日 9:30-11:30, 13:00-15:00（中国股市交易时间）
- **监控频率**: 可配置，默认30分钟检查一次
- **自动暂停**: 非交易时间自动暂停，节省资源

### 📊 多维度分析
- **股息收益率**: TTM股息率分析
- **估值指标**: PE、PB比率评估
- **技术位置**: 52周高低点位置分析
- **基本面**: EPS、账面价值等财务指标

## 使用方法

### 1. 启动监控

```bash
# 使用默认配置启动监控
uv run python main.py monitor start

# 自定义股票文件和监控间隔
uv run python main.py monitor start --file custom_stocks.txt --interval 15
```

### 2. 查看监控状态

```bash
uv run python main.py monitor status
```

### 3. 停止监控

```bash
uv run python main.py monitor stop
```

## 配置文件

### sample_stocks.txt 格式
```
# 注释行以#开头
SH600000  # 浦发银行
SH601398  # 工商银行
SH600036  # 招商银行
```

支持的股票代码格式：
- `600000` (上海证券交易所)
- `SH600000`
- `000001` (深圳证券交易所)
- `SZ000001`

## 信号判断逻辑

### 买入信号条件
必须满足至少2个以下条件：

1. **评分条件** (权重最高)
   - 强信号: 评分 ≥ 85分
   - 中信号: 评分 ≥ 75分
   - 弱信号: 评分 ≥ 70分

2. **股息率条件**
   - 强信号: 股息率 ≥ 6%
   - 中信号: 股息率 ≥ 5%
   - 弱信号: 股息率 ≥ 4%

3. **估值条件**
   - PE < 15 (低估值)
   - PB < 1.5 (低估值)

4. **技术位置条件**
   - 价格距52周低点 < 20%

5. **价格回调条件**
   - 相比上次检测下跌 ≥ 5%

### 卖出信号条件
必须满足至少2个以下条件：

1. **评分下降**
   - 强信号: 评分 ≤ 20分
   - 中信号: 评分 ≤ 25分
   - 弱信号: 评分 ≤ 30分

2. **股息率下降**
   - 股息率 ≤ 2%

3. **估值过高**
   - PE > 30
   - PB > 5

4. **技术位置条件**
   - 价格距52周高点 < 10%

5. **盈利了结条件**
   - 相比买入价格上涨 ≥ 20%

## 通知和报告

### 实时通知
- 控制台实时显示交易信号
- 强信号优先显示
- 包含股票名称、代码、价格、评分、触发原因

### 报告文件
- **JSON格式**: 详细信号数据 (`data/monitoring/`)
- **HTML格式**: 每日监控报告 (`reports/`)
- **CSV格式**: 信号汇总表 (`reports/`)

### 报告内容
- 信号统计（买入/卖出/强/中/弱）
- 股票状态变化
- 监控会话摘要
- 触发原因详细说明

## 示例输出

### 买入信号示例
```
🔥 强信号
🟢 买入 招商银行 (SH600036)
  价格: ¥42.15 | 评分: 87.2
  目标价: ¥52.69
  理由: 评分优异(87.2≥85), 高股息率(5.8%≥6%), 低估值(PE=12.3<15)
  时间: 14:30:25
```

### 卖出信号示例
```
🔥 强信号
🔴 卖出 工商银行 (SH601398)
  价格: ¥5.89 | 评分: 18.5
  理由: 评分恶化(18.5≤20), 估值过高(PE=35.2>30), 每股收益为负
  时间: 10:15:42
```

## 注意事项

### ⚠️ 重要提醒
1. **非投资建议**: 本系统仅供学习和研究使用，不构成投资建议
2. **数据延迟**: 基于公开数据源，可能存在数据延迟
3. **市场风险**: 股市有风险，投资需谨慎
4. **系统限制**: 仅在交易时间运行，非交易时间不会检测信号

### 🔧 技术说明
- 系统自动检测交易日，周末和节假日不运行
- 监控数据保存在 `data/monitoring/` 目录
- 报告文件保存在 `reports/` 目录
- 日志文件保存在 `logs/` 目录

### 📞 支持
如遇问题，请检查：
1. 网络连接是否正常
2. 股票代码格式是否正确
3. 是否在交易时间内运行
4. 查看日志文件排查错误

## 高级配置

系统支持通过修改配置文件调整参数，具体可参考：
- `src/buffett/core/config.py` - 核心配置
- `src/buffett/models/monitoring.py` - 监控配置

建议普通用户使用默认配置，高级用户可根据需要调整阈值。